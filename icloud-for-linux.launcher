#!/bin/sh

# Disable the chromium sandbox to work around https://launchpad.net/bugs/1599234.
# Rely on snapdâ€™s security policy instead.
export OXIDE_NO_SANDBOX=1

# Explicitly set APP_ID.
export APP_ID=icloud-for-linux

# Enable Qt HiDPI support
export QT_AUTO_SCREEN_SCALE_FACTOR=1

# Remove problematic environment variable
unset QT_QPA_PLATFORM

# Suppress "unsupported browser" warnings
if [ ! -d $SNAP_USER_DATA/.local/share/QtProject ]; then
  mkdir -p $SNAP_USER_DATA/.local/share
  cp -r $SNAP/share/QtProject $SNAP_USER_DATA/.local/share
fi

exec "$SNAP/bin/desktop-launch" "qmlscene" "$1" "$2" "$SNAP/icloud-for-linux.qml"
